<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>preloading</title>
	<style type="text/css">
		html, body {
			height: 100%;
		}
		.box {
			text-align: center;
		}
		.btn {
			display: inline-block;
			height: 32px;
			margin-top: 20px;
			margin-right: 20px;
		}
		.loading {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #eee;
			text-align: center;
			font-size: 30px;
		}
		.progress {
			margin-top: 300px;
		}
	</style>
	<script type="text/javascript" src="js/jquery-1.12.3.js" ></script>
	<script type="text/javascript" src="js/preload.js"></script>
</head>
<body>
	<div class="box">
		<img id="img" alt="pic1" src="https://s-media-cache-ak0.pinimg.com/736x/0f/46/8b/0f468b242a051993fbea928afaa3ba1e--harbour-island-bahamas-the-bahamas.jpg" width="800px">
		<div>
			<a href="javaScript:;" class="btn" data-control="pre">上一页</a>
			<a href="javaScript:;" class="btn" data-control="next">下一页</a>
		</div>
	</div>
	<div class="loading">
		<p class="progress">0%</p>
	</div>
	<script>
		// var imgs = [
		// 	"https://s-media-cache-ak0.pinimg.com/736x/0f/46/8b/0f468b242a051993fbea928afaa3ba1e--harbour-island-bahamas-the-bahamas.jpg",
		// 	"http://www.mydeskcity.com//upload/pc/103/960x600/1348722469160.jpg",
		// 	"https://2.bp.blogspot.com/-8fTgwHz5nGA/V05Voo_ibZI/AAAAAAAABcY/WqS2eRh4i7AzWKA5veLWfJ7pwsQLT5xfQCLcB/s1600/13256197_1158028580884343_1011761409620824075_n.jpg",
		// 	"https://lh4.ggpht.com/W3jGCU9aOTMr3RevqSaJFEmF7zfAfTRr8Oo4mWtQONx8rn2F-FNWURdbyA23jS7MyA",
		// 	"http://www.twwiki.com/uploads/wiki/ba/5c/404159_0.jpg"
		// ];
		// var len = imgs.length,
		//     index = 0,
		//     count = 0,
		//     $progress = $('.progress');
		//
		// $.each(imgs, function (i, src) {
		// 	var imgObj = new Image();
		//
		// 	$(imgObj).on('load error', function () {
		// 		$progress.html(Math.round((count+1) / len * 100)+ '%');
		// 		if (count >= len-1) {
		// 			$(".loading").hide();
		// 			document.title = '1/' + len;
		// 		};
		// 		count++;
		// 	});
		// 	imgObj.src = src;
		//
		// })
		//
		// $(".btn").on('click', function () {
		// 	if ('pre' === $(this).data('control')) {
		// 		index = Math.max(0, --index);
		// 	} else {
		// 		index = Math.min(len-1, ++index);
		// 	}
		// 	document.title = (index+1) + '/' + len;
		// 	$('#img').attr('src', imgs[index]);
		// });
		var imgs = [
			"https://s-media-cache-ak0.pinimg.com/736x/0f/46/8b/0f468b242a051993fbea928afaa3ba1e--harbour-island-bahamas-the-bahamas.jpg",
			"http://www.mydeskcity.com//upload/pc/103/960x600/1348722469160.jpg",
			"https://2.bp.blogspot.com/-8fTgwHz5nGA/V05Voo_ibZI/AAAAAAAABcY/WqS2eRh4i7AzWKA5veLWfJ7pwsQLT5xfQCLcB/s1600/13256197_1158028580884343_1011761409620824075_n.jpg",
			"https://lh4.ggpht.com/W3jGCU9aOTMr3RevqSaJFEmF7zfAfTRr8Oo4mWtQONx8rn2F-FNWURdbyA23jS7MyA",
			"http://www.twwiki.com/uploads/wiki/ba/5c/404159_0.jpg"
		];
		var len = imgs.length,
		    index = 0,
		    $progress = $('.progress');

		$.preload(imgs, {
			each: function (count) {
				$progress.html(Math.round((count+1) / len * 100)+ '%');
			},
			all: function () {
				$(".loading").hide();
				document.title = '1/' + len;
			}
		})

		$(".btn").on('click', function () {
			if ('pre' === $(this).data('control')) {
				index = Math.max(0, --index);
			} else {
				index = Math.min(len-1, ++index);
			}
			document.title = (index+1) + '/' + len;
			$('#img').attr('src', imgs[index]);
		});
	</script>
</body>
</html>
